{{- if not (.Values.adminUser.existingSecret) -}}
apiVersion: v1
kind: Secret
metadata:
  labels:
    {{- include "sdnc-influxdb.labels" . | nindent 4 }}
  {{- $name := printf "%s-auth" (include "sdnc-influxdb.fullname" .) }}
  name: {{ $name }}
  namespace: {{ include "sdnc.namespace" . }}
data:
  {{- if .Values.adminUser.token }}
  admin-token: {{ .Values.adminUser.token  | b64enc | quote }}
  {{- else }}
  admin-token: {{ randAlphaNum 32 | b64enc | quote }}
  {{- end }}

  {{- if .Values.global.inflxdb.password }}
  admin-password: {{ .Values.global.inflxdb.password | b64enc | quote }}
  {{- else if .Values.adminUser.password }}
  admin-password: {{ .Values.adminUser.password | b64enc | quote }}
  {{- else }}
  admin-password: {{ randAlphaNum 32 | b64enc | quote }}
  {{- end }}
{{- end -}}
